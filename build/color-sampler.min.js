/*
 * color-sampler v0.1.1
 * https://github.com/emn178/color-sampler
 *
 * Copyright 2015, emn178@gmail.com
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
(function(b,u,v,p){function c(a,l){this.canvas=b(a);this.options=l||{};this.enabled=!0;this.context=a.getContext("2d");this.resize();this.canvas.on("mousemove",this.onMousemove.bind(this));this.canvas.on("mouseout",this.onMouseout.bind(this));this.canvas.on("click",this.onClick.bind(this))}function w(){b(":color-sampler").each(function(){b(this).data("color-sampler").resize()})}function x(){d=b('<div class="color-sampler-preview"/>');var a=b("<table/>");d.append(a);for(var l=0;11>l;++l){for(var f=
b("<tr>"),e=0;11>e;++e){var c=b("<td></td>").attr("x",e).attr("y",l);m.push(c);f.append(c)}a.append(f)}b("body").append(d)}function q(){n&&(n=!1,d.removeClass("active"))}function r(){g=g.filter(":color-sampler");g.each(function(){b(this).data("color-sampler").detect()});0===g.length&&(h=clearInterval(h))}var y=["padding","border"],t=!1,d,m=[],n=!1,k=200,h,g=b();b.expr[":"]["color-sampler"]=function(a){return b(a).data("color-sampler")!==p};c.prototype.resize=function(){var a=this.canvas,b={left:0,
top:0};y.forEach(function(f){b.left+=parseInt(a.css(f+"-left"))||0;b.top+=parseInt(a.css(f+"-top"))||0});b.right=a.width();b.bottom=a.height();this.bounds=b};c.prototype.onMousemove=function(a){if(this.enabled){var l=this.canvas,f=this.bounds,e=a.offsetX-f.left,c=a.offsetY-f.top;0>e||0>c||e>=f.right||c>=f.bottom?q():(d.css({left:a.pageX+5+"px",top:a.pageY+5+"px"}),this.setupPreview(e,c),n||(n=!0,d.addClass("active")),this.color=m[60].css("background-color"),b.isFunction(this.options.onPreview)&&this.options.onPreview.call(l,
this.color))}};c.prototype.setupPreview=function(a,b){for(var c=a-5,e=b-5,h=this.context.getImageData(c,e,11,11).data,d=0,g=0;d<h.length;d+=4,++g){var k=parseInt(g/11)+e;0>g%11+c||0>k?m[g].css("background-color","white"):(k="rgba("+h.slice(d,d+4).join(",")+")",m[g].css("background-color",k))}};c.prototype.onMouseout=function(){q()};c.prototype.onClick=function(a){this.color&&b.isFunction(this.options.onSelect)&&this.options.onSelect.call(this.canvas,this.color)};c.prototype.detect=function(){this.canvas.width()==
this.bounds.right&&this.canvas.height()==this.bounds.bottom||this.resize()};c.prototype.enable=function(a){a===p&&(a=!0);this.enabled=a};c.prototype.disable=function(a){a===p&&(a=!0);this.enabled=!a};var z=["enable","disable","resize"];b.fn.colorSampler=function(a,d){var f="string"==typeof a;this.filter("canvas").each(function(){if(f){if(-1!=b.inArray(a,z)){var e=b(this).data("color-sampler");e&&e[a].apply(e,d)}}else d=a,e=new c(this,d),b(this).data("color-sampler",e),t||(t=!0,x(),b(v).ready(function(){b(u).bind("resize",
w)})),g=g.add(this),k&&!h&&(h=setInterval(r,k))});return this};b.colorSamper={};b.colorSamper.setInterval=function(a){a==k||!b.isNumeric(a)||0>a||(k=a,h=clearInterval(h),0<k&&(h=setInterval(r,k)))}})(jQuery,window,document);
