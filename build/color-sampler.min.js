/*
 * color-sampler v0.1.0
 * https://github.com/emn178/color-sampler
 *
 * Copyright 2015, emn178@gmail.com
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
(function(d,q,r,m){function c(a,b){this.canvas=d(a);this.options=b||{};this.enabled=!0;this.context=a.getContext("2d");this.bound();this.canvas.on("mousemove",this.onMousemove.bind(this));this.canvas.on("mouseout",this.onMouseout.bind(this));this.canvas.on("click",this.onClick.bind(this))}function t(){d(":color-sampler").each(function(){d(this).data("color-sampler").bound()})}function u(){e=d('<div class="color-sampler-preview"/>');var a=d("<table/>");e.append(a);for(var b=0;11>b;++b){for(var f=d("<tr>"),
l=0;11>l;++l){var c=d("<td></td>").attr("x",l).attr("y",b);k.push(c);f.append(c)}a.append(f)}d("body").append(e)}function n(){g&&(g=!1,e.removeClass("active"))}navigator.userAgent.indexOf("MSIE 7.0");var v=["padding","border"],p=!1,e,k=[],g=!1;c.prototype.bound=function(){var a=this.canvas,b={left:0,top:0};v.forEach(function(f){b.left+=parseInt(a.css(f+"-left"))||0;b.top+=parseInt(a.css(f+"-top"))||0});b.right=a.width();b.bottom=a.height();this.bounds=b};c.prototype.onMousemove=function(a){if(this.enabled){var b=
this.bounds,f=a.offsetX-b.left,c=a.offsetY-b.top;0>f||0>c||f>b.right||c>b.bottom?n():(e.css({left:a.pageX+5+"px",top:a.pageY+5+"px"}),this.setupPreview(f,c),g||(g=!0,e.addClass("active")),this.color=k[60].css("background-color"),d.isFunction(this.options.onPreview)&&this.options.onPreview.call(this.canvas,this.color))}};c.prototype.setupPreview=function(a,b){for(var f=a-5,d=b-5,c=this.context.getImageData(f,d,11,11).data,e=0,h=0;e<c.length;e+=4,++h){var g=parseInt(h/11)+d;0>h%11+f||0>g?k[h].css("background-color",
"white"):(g="rgba("+c.slice(e,e+4).join(",")+")",k[h].css("background-color",g))}};c.prototype.onMouseout=function(){n()};c.prototype.onClick=function(a){this.color&&d.isFunction(this.options.onSelect)&&this.options.onSelect.call(this.canvas,this.color)};c.prototype.enable=function(a){a===m&&(a=!0);this.enabled=a};c.prototype.disable=function(a){a===m&&(a=!0);this.enabled=!a};var w=["enable","disable"];d.fn.colorSampler=function(a,b){"string"==typeof a?-1!=d.inArray(a,w)&&this.filter("canvas").each(function(){var c=
d(this).data("color-sampler");c&&c[a].apply(c,b)}):(b=a,this.filter("canvas").each(function(){var a=new c(this,b);d(this).data("color-sampler",a)}),p||(p=!0,u(),d(r).ready(function(){d(q).bind("resize",t)})));return this}})(jQuery,window,document);
